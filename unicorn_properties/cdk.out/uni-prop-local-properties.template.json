{
 "Resources": {
  "UnicornPropertiesBuslocal2042F62D": {
   "Type": "AWS::Events::EventBus",
   "Properties": {
    "Name": "UnicornPropertiesBus-local"
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/UnicornPropertiesBus-local/Resource"
   }
  },
  "UnicornPropertiesCatchAllLogGroup057F9994": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/aws/events/local/unicorn.properties-catchall",
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/UnicornPropertiesCatchAllLogGroup/Resource"
   }
  },
  "UnicornPropertiesEventsBusPublishPolicy": {
   "Type": "AWS::Events::EventBusPolicy",
   "Properties": {
    "EventBusName": {
     "Ref": "UnicornPropertiesBuslocal2042F62D"
    },
    "Statement": {
     "Action": "events:PutEvents",
     "Condition": {
      "StringEquals": {
       "aws:Source": "unicorn.properties"
      }
     },
     "Effect": "Allow",
     "Principal": {
      "AWS": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":iam::",
         {
          "Ref": "AWS::AccountId"
         },
         ":root"
        ]
       ]
      }
     },
     "Resource": {
      "Fn::GetAtt": [
       "UnicornPropertiesBuslocal2042F62D",
       "Arn"
      ]
     },
     "Sid": "OnlyPropertiesServiceCanPublishToEventBus-local"
    },
    "StatementId": "OnlyPropertiesServiceCanPublishToEventBus-local"
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/UnicornPropertiesEventsBusPublishPolicy"
   }
  },
  "UnicornPropertiesCatchAllRule9EAFE704": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "Description": "Catch all events published by the conproperties service.",
    "EventBusName": {
     "Ref": "UnicornPropertiesBuslocal2042F62D"
    },
    "EventPattern": {
     "account": [
      {
       "Ref": "AWS::AccountId"
      }
     ],
     "source": [
      "unicorn.contracts",
      "unicorn.properties",
      "unicorn.web"
     ]
    },
    "Name": "unicorn.contracts-catchall",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":logs:",
         {
          "Ref": "AWS::Region"
         },
         ":",
         {
          "Ref": "AWS::AccountId"
         },
         ":log-group:",
         {
          "Ref": "UnicornPropertiesCatchAllLogGroup057F9994"
         }
        ]
       ]
      },
      "Id": "Target0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/UnicornPropertiesCatchAllRule/Resource"
   }
  },
  "EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E7417BF5E": {
   "Type": "Custom::CloudwatchLogResourcePolicy",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
      "Arn"
     ]
    },
    "Create": {
     "Fn::Join": [
      "",
      [
       "{\"service\":\"CloudWatchLogs\",\"action\":\"putResourcePolicy\",\"parameters\":{\"policyName\":\"uniproplocalpropertiesEventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E9D78F64E\",\"policyDocument\":\"{\\\"Statement\\\":[{\\\"Action\\\":[\\\"logs:PutLogEvents\\\",\\\"logs:CreateLogStream\\\"],\\\"Effect\\\":\\\"Allow\\\",\\\"Principal\\\":{\\\"Service\\\":\\\"events.amazonaws.com\\\"},\\\"Resource\\\":\\\"",
       {
        "Fn::GetAtt": [
         "UnicornPropertiesCatchAllLogGroup057F9994",
         "Arn"
        ]
       },
       "\\\"}],\\\"Version\\\":\\\"2012-10-17\\\"}\"},\"physicalResourceId\":{\"id\":\"EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E\"}}"
      ]
     ]
    },
    "Update": {
     "Fn::Join": [
      "",
      [
       "{\"service\":\"CloudWatchLogs\",\"action\":\"putResourcePolicy\",\"parameters\":{\"policyName\":\"uniproplocalpropertiesEventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E9D78F64E\",\"policyDocument\":\"{\\\"Statement\\\":[{\\\"Action\\\":[\\\"logs:PutLogEvents\\\",\\\"logs:CreateLogStream\\\"],\\\"Effect\\\":\\\"Allow\\\",\\\"Principal\\\":{\\\"Service\\\":\\\"events.amazonaws.com\\\"},\\\"Resource\\\":\\\"",
       {
        "Fn::GetAtt": [
         "UnicornPropertiesCatchAllLogGroup057F9994",
         "Arn"
        ]
       },
       "\\\"}],\\\"Version\\\":\\\"2012-10-17\\\"}\"},\"physicalResourceId\":{\"id\":\"EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E\"}}"
      ]
     ]
    },
    "Delete": "{\"service\":\"CloudWatchLogs\",\"action\":\"deleteResourcePolicy\",\"parameters\":{\"policyName\":\"uniproplocalpropertiesEventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E9D78F64E\"},\"ignoreErrorCodesMatching\":\"ResourceNotFoundException\"}",
    "InstallLatestAwsSdk": false
   },
   "DependsOn": [
    "EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7ECustomResourcePolicyBB9A9C8E"
   ],
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E/Resource/Default"
   }
  },
  "EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7ECustomResourcePolicyBB9A9C8E": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "logs:DeleteResourcePolicy",
        "logs:PutResourcePolicy"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7ECustomResourcePolicyBB9A9C8E",
    "Roles": [
     {
      "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/EventsLogGroupPolicyuniproplocalpropertiesUnicornPropertiesCatchAllRuleCA1ADD7E/CustomResourcePolicy/Resource"
   }
  },
  "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource"
   }
  },
  "AWS679f53fac002430cb0da5b7982bd22872D164C4C": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "ce2f3595a340d6c519a65888ef97e3b9b64f053f83608e32cc28162e22d7d99a.zip"
    },
    "Handler": "index.handler",
    "Role": {
     "Fn::GetAtt": [
      "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
      "Arn"
     ]
    },
    "Runtime": {
     "Fn::FindInMap": [
      "LatestNodeRuntimeMap",
      {
       "Ref": "AWS::Region"
      },
      "value"
     ]
    },
    "Timeout": 120
   },
   "DependsOn": [
    "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/AWS679f53fac002430cb0da5b7982bd2287/Resource",
    "aws:asset:path": "asset.ce2f3595a340d6c519a65888ef97e3b9b64f053f83608e32cc28162e22d7d99a",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "ContractStatusTableF5E34442": {
   "Type": "AWS::DynamoDB::GlobalTable",
   "Properties": {
    "AttributeDefinitions": [
     {
      "AttributeName": "property_id",
      "AttributeType": "S"
     }
    ],
    "BillingMode": "PAY_PER_REQUEST",
    "KeySchema": [
     {
      "AttributeName": "property_id",
      "KeyType": "HASH"
     }
    ],
    "Replicas": [
     {
      "Region": {
       "Ref": "AWS::Region"
      }
     }
    ],
    "StreamSpecification": {
     "StreamViewType": "NEW_AND_OLD_IMAGES"
    },
    "TableName": "uni-prop-local-properties-ContractStatusTable"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractStatusTable/Resource"
   }
  },
  "PropertiesEventBusRuleDLQE70E543B": {
   "Type": "AWS::SQS::Queue",
   "Properties": {
    "MessageRetentionPeriod": 1209600,
    "QueueName": "PropertiesEventBusRuleDLQ-local"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesEventBusRuleDLQ/Resource"
   }
  },
  "PropertiesEventBusRuleDLQPolicyBF5784B3": {
   "Type": "AWS::SQS::QueuePolicy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "sqs:SendMessage",
       "Condition": {
        "ArnEquals": {
         "aws:SourceArn": {
          "Fn::GetAtt": [
           "unicornpropertiesContractStatusChanged15A011AE",
           "Arn"
          ]
         }
        }
       },
       "Effect": "Allow",
       "Principal": {
        "Service": "events.amazonaws.com"
       },
       "Resource": {
        "Fn::GetAtt": [
         "PropertiesEventBusRuleDLQE70E543B",
         "Arn"
        ]
       },
       "Sid": "AllowEventRuleuniproplocalpropertiesunicornpropertiesContractStatusChanged9FA2B6E7"
      },
      {
       "Action": "sqs:SendMessage",
       "Condition": {
        "ArnEquals": {
         "aws:SourceArn": {
          "Fn::GetAtt": [
           "unicornpropertiesPublicationApprovalRequested1AA17865",
           "Arn"
          ]
         }
        }
       },
       "Effect": "Allow",
       "Principal": {
        "Service": "events.amazonaws.com"
       },
       "Resource": {
        "Fn::GetAtt": [
         "PropertiesEventBusRuleDLQE70E543B",
         "Arn"
        ]
       },
       "Sid": "AllowEventRuleuniproplocalpropertiesunicornpropertiesPublicationApprovalRequestedACA676F8"
      }
     ],
     "Version": "2012-10-17"
    },
    "Queues": [
     {
      "Ref": "PropertiesEventBusRuleDLQE70E543B"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesEventBusRuleDLQ/Policy/Resource"
   }
  },
  "PropertiesServiceDLQE9A990DB": {
   "Type": "AWS::SQS::Queue",
   "Properties": {
    "MessageRetentionPeriod": 1209600,
    "QueueName": "PropertiesServiceDLQ-local"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesServiceDLQ/Resource"
   }
  },
  "ContractStatusChangedHandlerFunctionLogGrouplocalFC78CE21": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractStatusChangedHandlerFunctionLogGroup-local/Resource"
   }
  },
  "ContractStatusChangedHandlerFunctionlocalServiceRoleCCA43736": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractStatusChangedHandlerFunction-local/ServiceRole/Resource"
   }
  },
  "ContractStatusChangedHandlerFunctionlocalServiceRoleDefaultPolicy9858D6EC": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:ConditionCheckItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable",
        "dynamodb:GetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:PutItem",
        "dynamodb:Query",
        "dynamodb:Scan",
        "dynamodb:UpdateItem"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "ContractStatusTableF5E34442",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "sqs:GetQueueAttributes",
        "sqs:GetQueueUrl",
        "sqs:SendMessage"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "PropertiesServiceDLQE9A990DB",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ContractStatusChangedHandlerFunctionlocalServiceRoleDefaultPolicy9858D6EC",
    "Roles": [
     {
      "Ref": "ContractStatusChangedHandlerFunctionlocalServiceRoleCCA43736"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractStatusChangedHandlerFunction-local/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ContractStatusChangedHandlerFunctionlocalE63ECA03": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Architectures": [
     "x86_64"
    ],
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2.zip"
    },
    "Environment": {
     "Variables": {
      "SERVICE_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOGGER_CASE": "PascalCase",
      "POWERTOOLS_SERVICE_NAME": "unicorn.properties",
      "POWERTOOLS_TRACE_DISABLED": "false",
      "POWERTOOLS_LOGGER_LOG_EVENT": "true",
      "POWERTOOLS_LOGGER_SAMPLE_RATE": "0",
      "POWERTOOLS_METRICS_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOG_LEVEL": "INFO",
      "LOG_LEVEL": "INFO",
      "CONTRACT_STATUS_TABLE": {
       "Ref": "ContractStatusTableF5E34442"
      }
     }
    },
    "FunctionName": "ContractStatusChangedHandlerFunction-local-local",
    "Handler": "properties_service.contract_status_changed_event_handler.lambda_handler",
    "LoggingConfig": {
     "LogGroup": {
      "Ref": "ContractStatusChangedHandlerFunctionLogGrouplocalFC78CE21"
     }
    },
    "Role": {
     "Fn::GetAtt": [
      "ContractStatusChangedHandlerFunctionlocalServiceRoleCCA43736",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 30,
    "TracingConfig": {
     "Mode": "Active"
    }
   },
   "DependsOn": [
    "ContractStatusChangedHandlerFunctionlocalServiceRoleDefaultPolicy9858D6EC",
    "ContractStatusChangedHandlerFunctionlocalServiceRoleCCA43736"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractStatusChangedHandlerFunction-local/Resource",
    "aws:asset:path": "asset.41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "unicornpropertiesContractStatusChanged15A011AE": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "EventBusName": {
     "Ref": "UnicornPropertiesBuslocal2042F62D"
    },
    "EventPattern": {
     "detail-type": [
      "ContractStatusChanged"
     ],
     "source": [
      "unicorn.contracts"
     ]
    },
    "Name": "unicorn.properties-ContractStatusChanged",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::GetAtt": [
        "ContractStatusChangedHandlerFunctionlocalE63ECA03",
        "Arn"
       ]
      },
      "DeadLetterConfig": {
       "Arn": {
        "Fn::GetAtt": [
         "PropertiesEventBusRuleDLQE70E543B",
         "Arn"
        ]
       }
      },
      "Id": "Target0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/unicorn.properties-ContractStatusChanged/Resource"
   }
  },
  "unicornpropertiesContractStatusChangedAllowEventRuleuniproplocalpropertiesContractStatusChangedHandlerFunctionlocal5B01E3E0C5EDF417": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "ContractStatusChangedHandlerFunctionlocalE63ECA03",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "unicornpropertiesContractStatusChanged15A011AE",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/unicorn.properties-ContractStatusChanged/AllowEventRuleuniproplocalpropertiesContractStatusChangedHandlerFunctionlocal5B01E3E0"
   }
  },
  "PropertiesApprovalSyncFunctionLogGrouplocal9A16B938": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesApprovalSyncFunctionLogGroup-local/Resource"
   }
  },
  "PropertiesApprovalSyncFunctionlocalServiceRole0C471955": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesApprovalSyncFunction-local/ServiceRole/Resource"
   }
  },
  "PropertiesApprovalSyncFunctionlocalServiceRoleDefaultPolicy62DB4FC9": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "sqs:GetQueueAttributes",
        "sqs:GetQueueUrl",
        "sqs:SendMessage"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "PropertiesServiceDLQE9A990DB",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "dynamodb:DescribeStream",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:ListStreams"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "ContractStatusTableF5E34442",
         "StreamArn"
        ]
       }
      },
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:ConditionCheckItem",
        "dynamodb:DescribeTable",
        "dynamodb:GetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:Scan"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "ContractStatusTableF5E34442",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "states:SendTaskFailure",
        "states:SendTaskHeartbeat",
        "states:SendTaskSuccess"
       ],
       "Effect": "Allow",
       "Resource": {
        "Ref": "ApprovalStateMachine767589AA"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "PropertiesApprovalSyncFunctionlocalServiceRoleDefaultPolicy62DB4FC9",
    "Roles": [
     {
      "Ref": "PropertiesApprovalSyncFunctionlocalServiceRole0C471955"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesApprovalSyncFunction-local/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "PropertiesApprovalSyncFunctionlocal69C8A5CE": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Architectures": [
     "x86_64"
    ],
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2.zip"
    },
    "Environment": {
     "Variables": {
      "SERVICE_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOGGER_CASE": "PascalCase",
      "POWERTOOLS_SERVICE_NAME": "unicorn.properties",
      "POWERTOOLS_TRACE_DISABLED": "false",
      "POWERTOOLS_LOGGER_LOG_EVENT": "true",
      "POWERTOOLS_LOGGER_SAMPLE_RATE": "0",
      "POWERTOOLS_METRICS_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOG_LEVEL": "INFO",
      "LOG_LEVEL": "INFO",
      "CONTRACT_STATUS_TABLE": {
       "Ref": "ContractStatusTableF5E34442"
      }
     }
    },
    "FunctionName": "PropertiesApprovalSyncFunction-local-local",
    "Handler": "properties_service.properties_approval_sync_function.lambda_handler",
    "LoggingConfig": {
     "LogGroup": {
      "Ref": "PropertiesApprovalSyncFunctionLogGrouplocal9A16B938"
     }
    },
    "Role": {
     "Fn::GetAtt": [
      "PropertiesApprovalSyncFunctionlocalServiceRole0C471955",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 30,
    "TracingConfig": {
     "Mode": "Active"
    }
   },
   "DependsOn": [
    "PropertiesApprovalSyncFunctionlocalServiceRoleDefaultPolicy62DB4FC9",
    "PropertiesApprovalSyncFunctionlocalServiceRole0C471955"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesApprovalSyncFunction-local/Resource",
    "aws:asset:path": "asset.41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "PropertiesApprovalSyncFunctionlocalDynamoDBEventSourceuniproplocalpropertiesContractStatusTable446352ED71D1B772": {
   "Type": "AWS::Lambda::EventSourceMapping",
   "Properties": {
    "BatchSize": 100,
    "DestinationConfig": {
     "OnFailure": {
      "Destination": {
       "Fn::GetAtt": [
        "PropertiesServiceDLQE9A990DB",
        "Arn"
       ]
      }
     }
    },
    "EventSourceArn": {
     "Fn::GetAtt": [
      "ContractStatusTableF5E34442",
      "StreamArn"
     ]
    },
    "FunctionName": {
     "Ref": "PropertiesApprovalSyncFunctionlocal69C8A5CE"
    },
    "StartingPosition": "TRIM_HORIZON"
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PropertiesApprovalSyncFunction-local/DynamoDBEventSource:uniproplocalpropertiesContractStatusTable446352ED/Resource"
   }
  },
  "ContractExistsCheckerFunctionLogGrouplocal76EFD971": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractExistsCheckerFunctionLogGroup-local/Resource"
   }
  },
  "ContractExistsCheckerFunctionlocalServiceRole403DE853": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractExistsCheckerFunction-local/ServiceRole/Resource"
   }
  },
  "ContractExistsCheckerFunctionlocalServiceRoleDefaultPolicyDE5DD650": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:ConditionCheckItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable",
        "dynamodb:GetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:PutItem",
        "dynamodb:Query",
        "dynamodb:Scan",
        "dynamodb:UpdateItem"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "ContractStatusTableF5E34442",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ContractExistsCheckerFunctionlocalServiceRoleDefaultPolicyDE5DD650",
    "Roles": [
     {
      "Ref": "ContractExistsCheckerFunctionlocalServiceRole403DE853"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractExistsCheckerFunction-local/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ContractExistsCheckerFunctionlocalA9DDED8C": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Architectures": [
     "x86_64"
    ],
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2.zip"
    },
    "Environment": {
     "Variables": {
      "SERVICE_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOGGER_CASE": "PascalCase",
      "POWERTOOLS_SERVICE_NAME": "unicorn.properties",
      "POWERTOOLS_TRACE_DISABLED": "false",
      "POWERTOOLS_LOGGER_LOG_EVENT": "true",
      "POWERTOOLS_LOGGER_SAMPLE_RATE": "0",
      "POWERTOOLS_METRICS_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOG_LEVEL": "INFO",
      "LOG_LEVEL": "INFO",
      "CONTRACT_STATUS_TABLE": {
       "Ref": "ContractStatusTableF5E34442"
      }
     }
    },
    "FunctionName": "ContractExistsCheckerFunction-local-local",
    "Handler": "properties_service.contract_exists_checker_function.lambda_handler",
    "LoggingConfig": {
     "LogGroup": {
      "Ref": "ContractExistsCheckerFunctionLogGrouplocal76EFD971"
     }
    },
    "Role": {
     "Fn::GetAtt": [
      "ContractExistsCheckerFunctionlocalServiceRole403DE853",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 30,
    "TracingConfig": {
     "Mode": "Active"
    }
   },
   "DependsOn": [
    "ContractExistsCheckerFunctionlocalServiceRoleDefaultPolicyDE5DD650",
    "ContractExistsCheckerFunctionlocalServiceRole403DE853"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContractExistsCheckerFunction-local/Resource",
    "aws:asset:path": "asset.41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "WaitForContractApprovalFunctionLogGrouplocal6BDA45B6": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/WaitForContractApprovalFunctionLogGroup-local/Resource"
   }
  },
  "WaitForContractApprovalFunctionlocalServiceRole53F34F6C": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/WaitForContractApprovalFunction-local/ServiceRole/Resource"
   }
  },
  "WaitForContractApprovalFunctionlocalServiceRoleDefaultPolicy54D250C0": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:ConditionCheckItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable",
        "dynamodb:GetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:PutItem",
        "dynamodb:Query",
        "dynamodb:Scan",
        "dynamodb:UpdateItem"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "ContractStatusTableF5E34442",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "WaitForContractApprovalFunctionlocalServiceRoleDefaultPolicy54D250C0",
    "Roles": [
     {
      "Ref": "WaitForContractApprovalFunctionlocalServiceRole53F34F6C"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/WaitForContractApprovalFunction-local/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "WaitForContractApprovalFunctionlocalB37F63DE": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Architectures": [
     "x86_64"
    ],
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2.zip"
    },
    "Environment": {
     "Variables": {
      "SERVICE_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOGGER_CASE": "PascalCase",
      "POWERTOOLS_SERVICE_NAME": "unicorn.properties",
      "POWERTOOLS_TRACE_DISABLED": "false",
      "POWERTOOLS_LOGGER_LOG_EVENT": "true",
      "POWERTOOLS_LOGGER_SAMPLE_RATE": "0",
      "POWERTOOLS_METRICS_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOG_LEVEL": "INFO",
      "LOG_LEVEL": "INFO",
      "CONTRACT_STATUS_TABLE": {
       "Ref": "ContractStatusTableF5E34442"
      }
     }
    },
    "FunctionName": "WaitForContractApprovalFunction-local-local",
    "Handler": "properties_service.wait_for_contract_approval_function.lambda_handler",
    "LoggingConfig": {
     "LogGroup": {
      "Ref": "WaitForContractApprovalFunctionLogGrouplocal6BDA45B6"
     }
    },
    "Role": {
     "Fn::GetAtt": [
      "WaitForContractApprovalFunctionlocalServiceRole53F34F6C",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 30,
    "TracingConfig": {
     "Mode": "Active"
    }
   },
   "DependsOn": [
    "WaitForContractApprovalFunctionlocalServiceRoleDefaultPolicy54D250C0",
    "WaitForContractApprovalFunctionlocalServiceRole53F34F6C"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/WaitForContractApprovalFunction-local/Resource",
    "aws:asset:path": "asset.41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "ContentIntegrityValidatorFunctionLogGrouplocal310E0303": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContentIntegrityValidatorFunctionLogGroup-local/Resource"
   }
  },
  "ContentIntegrityValidatorFunctionlocalServiceRoleAEDFC322": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContentIntegrityValidatorFunction-local/ServiceRole/Resource"
   }
  },
  "ContentIntegrityValidatorFunctionlocalServiceRoleDefaultPolicy97B5F059": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ContentIntegrityValidatorFunctionlocalServiceRoleDefaultPolicy97B5F059",
    "Roles": [
     {
      "Ref": "ContentIntegrityValidatorFunctionlocalServiceRoleAEDFC322"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContentIntegrityValidatorFunction-local/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ContentIntegrityValidatorFunctionlocal05E28B54": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Architectures": [
     "x86_64"
    ],
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2.zip"
    },
    "Environment": {
     "Variables": {
      "SERVICE_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOGGER_CASE": "PascalCase",
      "POWERTOOLS_SERVICE_NAME": "unicorn.properties",
      "POWERTOOLS_TRACE_DISABLED": "false",
      "POWERTOOLS_LOGGER_LOG_EVENT": "true",
      "POWERTOOLS_LOGGER_SAMPLE_RATE": "0",
      "POWERTOOLS_METRICS_NAMESPACE": "unicorn.properties",
      "POWERTOOLS_LOG_LEVEL": "INFO",
      "LOG_LEVEL": "INFO"
     }
    },
    "FunctionName": "ContentIntegrityValidatorFunction-local-local",
    "Handler": "properties_service.content_integrity_validator_function.lambda_handler",
    "LoggingConfig": {
     "LogGroup": {
      "Ref": "ContentIntegrityValidatorFunctionLogGrouplocal310E0303"
     }
    },
    "Role": {
     "Fn::GetAtt": [
      "ContentIntegrityValidatorFunctionlocalServiceRoleAEDFC322",
      "Arn"
     ]
    },
    "Runtime": "python3.13",
    "Timeout": 30,
    "TracingConfig": {
     "Mode": "Active"
    }
   },
   "DependsOn": [
    "ContentIntegrityValidatorFunctionlocalServiceRoleDefaultPolicy97B5F059",
    "ContentIntegrityValidatorFunctionlocalServiceRoleAEDFC322"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ContentIntegrityValidatorFunction-local/Resource",
    "aws:asset:path": "asset.41b29825c4a501cd77843c329f3cb8084f0b62b78cc715e5cdc69c3b075f32d2",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "ApprovalStateMachineLogGrouplocalF9763D65": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "RetentionInDays": 1
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ApprovalStateMachineLogGroup-local/Resource"
   }
  },
  "StateMachineRole78EC082E": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "states.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/AWSXRayDaemonWriteAccess"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/ComprehendFullAccess"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/AmazonRekognitionFullAccess"
       ]
      ]
     }
    ],
    "Policies": [
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": [
          "cloudwatch:PutMetricData",
          "logs:CreateLogDelivery",
          "logs:DeleteLogDelivery",
          "logs:DescribeLogGroups",
          "logs:DescribeResourcePolicies",
          "logs:GetLogDelivery",
          "logs:ListLogDeliveries",
          "logs:PutResourcePolicy",
          "logs:UpdateLogDelivery"
         ],
         "Effect": "Allow",
         "Resource": "*"
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "CloudWatchPublishLogsMetrics"
     },
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": "s3:Get*",
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:s3:::$",
            {
             "Ref": "SsmParameterValueuniproplocalImagesBucketC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "/*"
           ]
          ]
         }
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "S3ReadPolicy"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/StateMachineRole/Resource"
   }
  },
  "StateMachineRoleDefaultPolicy433448B5": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "logs:CreateLogDelivery",
        "logs:DeleteLogDelivery",
        "logs:DescribeLogGroups",
        "logs:DescribeResourcePolicies",
        "logs:GetLogDelivery",
        "logs:ListLogDeliveries",
        "logs:PutResourcePolicy",
        "logs:UpdateLogDelivery",
        "xray:GetSamplingRules",
        "xray:GetSamplingTargets",
        "xray:PutTelemetryRecords",
        "xray:PutTraceSegments"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "events:PutEvents",
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "UnicornPropertiesBuslocal2042F62D",
         "Arn"
        ]
       }
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ContentIntegrityValidatorFunctionlocal05E28B54",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "ContractExistsCheckerFunctionlocalA9DDED8C",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "WaitForContractApprovalFunctionlocalB37F63DE",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ContentIntegrityValidatorFunctionlocal05E28B54",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ContractExistsCheckerFunctionlocalA9DDED8C",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "WaitForContractApprovalFunctionlocalB37F63DE",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "StateMachineRoleDefaultPolicy433448B5",
    "Roles": [
     {
      "Ref": "StateMachineRole78EC082E"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/StateMachineRole/DefaultPolicy/Resource"
   }
  },
  "ApprovalStateMachine767589AA": {
   "Type": "AWS::StepFunctions::StateMachine",
   "Properties": {
    "DefinitionString": "{\n    \"Comment\": \"The property approval workflow ensures that its images and content is safe to publish and that there is an approved contract in place before the listing is made available to the public through the Unicorn Properties website.\",\n    \"StartAt\": \"VerifyContractExists\",\n    \"States\": {\n        \"VerifyContractExists\": {\n            \"Type\": \"Task\",\n            \"Resource\": \"arn:aws:states:::lambda:invoke\",\n            \"InputPath\": \"$.detail\",\n            \"ResultPath\": \"$.contract_exists_check\",\n            \"Parameters\": {\n                \"Payload\": {\n                    \"Input.$\": \"$\"\n                },\n                \"FunctionName\": \"${ContractExistsChecker}\"\n            },\n            \"Next\": \"CheckImageIntegrity\",\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\n                        \"ContractStatusNotFoundException\"\n                    ],\n                    \"Next\": \"NotFound\"\n                }\n            ],\n            \"Comment\": \"ContractExistsChecker checks to see if a contract for a specified property  exists.\"\n        },\n        \"NotFound\": {\n            \"Type\": \"Fail\"\n        },\n        \"CheckImageIntegrity\": {\n            \"Type\": \"Map\",\n            \"Parameters\": {\n                \"ImageName.$\": \"$$.Map.Item.Value\"\n            },\n            \"Iterator\": {\n                \"StartAt\": \"CheckForUnsafeContentInImages\",\n                \"States\": {\n                    \"CheckForUnsafeContentInImages\": {\n                        \"Type\": \"Task\",\n                        \"End\": true,\n                        \"Parameters\": {\n                            \"Image\": {\n                                \"S3Object\": {\n                                    \"Bucket\": \"${ImageUploadBucketName}\",\n                                    \"Name.$\": \"$.ImageName\"\n                                }\n                            }\n                        },\n                        \"Resource\": \"arn:aws:states:::aws-sdk:rekognition:detectModerationLabels\"\n                    }\n                }\n            },\n            \"Next\": \"CheckDescriptionSentiment\",\n            \"Comment\": \"Loop through all the images for the property and ensure they don't have unsafe content.\",\n            \"ItemsPath\": \"$.detail.images\",\n            \"ResultPath\": \"$.imageModerations\"\n        },\n        \"CheckDescriptionSentiment\": {\n            \"Type\": \"Task\",\n            \"Parameters\": {\n                \"LanguageCode\": \"en\",\n                \"Text.$\": \"$.detail.description\"\n            },\n            \"Resource\": \"arn:aws:states:::aws-sdk:comprehend:detectSentiment\",\n            \"Next\": \"ValidateContentIntegrity\",\n            \"ResultPath\": \"$.contentSentiment\"\n        },\n        \"ValidateContentIntegrity\": {\n            \"Type\": \"Task\",\n            \"Resource\": \"arn:aws:states:::lambda:invoke\",\n            \"ResultPath\": \"$.validation_check\",\n            \"ResultSelector\": {\n                \"validation_result.$\": \"$.Payload.validation_result\"\n            },\n            \"Parameters\": {\n                \"Payload.$\": \"$\",\n                \"FunctionName\": \"${ContentIntegrityValidator}\"\n            },\n            \"Retry\": [\n                {\n                    \"ErrorEquals\": [\n                        \"Lambda.ServiceException\",\n                        \"Lambda.AWSLambdaException\",\n                        \"Lambda.SdkClientException\"\n                    ],\n                    \"IntervalSeconds\": 2,\n                    \"MaxAttempts\": 6,\n                    \"BackoffRate\": 2\n                }\n            ],\n            \"Next\": \"IsContentSafe\"\n        },\n        \"IsContentSafe\": {\n            \"Type\": \"Choice\",\n            \"Choices\": [\n                {\n                    \"Variable\": \"$.validation_check.validation_result\",\n                    \"StringEquals\": \"PASS\",\n                    \"Next\": \"WaitForContractApproval\"\n                }\n            ],\n            \"Default\": \"PublicationEvaluationCompletedDeclined\"\n        },\n        \"PublicationEvaluationCompletedDeclined\": {\n            \"Type\": \"Task\",\n            \"Resource\": \"arn:aws:states:::events:putEvents\",\n            \"Parameters\": {\n                \"Entries\": [\n                    {\n                        \"Detail\": {\n                            \"property_id.$\": \"$.detail.property_id\",\n                            \"evaluation_result\": \"DECLINED\"\n                        },\n                        \"DetailType\": \"PublicationEvaluationCompleted\",\n                        \"EventBusName\": \"${EventBusName}\",\n                        \"Source\": \"${ServiceName}\"\n                    }\n                ]\n            },\n            \"Next\": \"Declined\"\n        },\n        \"Declined\": {\n            \"Type\": \"Succeed\"\n        },\n        \"WaitForContractApproval\": {\n            \"Type\": \"Task\",\n            \"Resource\": \"arn:aws:states:::lambda:invoke.waitForTaskToken\",\n            \"InputPath\": \"$.detail\",\n            \"ResultPath\": \"$.status_check\",\n            \"Parameters\": {\n                \"Payload\": {\n                    \"Input.$\": \"$\",\n                    \"TaskToken.$\": \"$$.Task.Token\"\n                },\n                \"FunctionName\": \"${WaitForContractApproval}\"\n            },\n            \"Retry\": [\n                {\n                    \"ErrorEquals\": [\n                        \"Lambda.ServiceException\",\n                        \"Lambda.AWSLambdaException\",\n                        \"Lambda.SdkClientException\"\n                    ],\n                    \"IntervalSeconds\": 2,\n                    \"MaxAttempts\": 6,\n                    \"BackoffRate\": 2\n                }\n            ],\n            \"Next\": \"PublicationEvaluationCompletedApproved\",\n            \"Comment\": \"ContractStatusChecker\"\n        },\n        \"PublicationEvaluationCompletedApproved\": {\n            \"Type\": \"Task\",\n            \"Resource\": \"arn:aws:states:::events:putEvents\",\n            \"Parameters\": {\n                \"Entries\": [\n                    {\n                        \"Detail\": {\n                            \"property_id.$\": \"$.detail.property_id\",\n                            \"evaluation_result\": \"APPROVED\"\n                        },\n                        \"DetailType\": \"PublicationEvaluationCompleted\",\n                        \"EventBusName\": \"${EventBusName}\",\n                        \"Source\": \"${ServiceName}\"\n                    }\n                ]\n            },\n            \"Next\": \"Approved\"\n        },\n        \"Approved\": {\n            \"Type\": \"Succeed\"\n        }\n    }\n}",
    "DefinitionSubstitutions": {
     "ContractExistsChecker": {
      "Fn::GetAtt": [
       "ContractExistsCheckerFunctionlocalA9DDED8C",
       "Arn"
      ]
     },
     "WaitForContractApproval": {
      "Fn::GetAtt": [
       "WaitForContractApprovalFunctionlocalB37F63DE",
       "Arn"
      ]
     },
     "ContentIntegrityValidator": {
      "Fn::GetAtt": [
       "ContentIntegrityValidatorFunctionlocal05E28B54",
       "Arn"
      ]
     },
     "ImageUploadBucketName": {
      "Ref": "SsmParameterValueuniproplocalImagesBucketC96584B6F00A464EAD1953AFF4B05118Parameter"
     },
     "EventBusName": {
      "Ref": "UnicornPropertiesBuslocal2042F62D"
     },
     "ServiceNmae": "unicorn.properties"
    },
    "LoggingConfiguration": {
     "Destinations": [
      {
       "CloudWatchLogsLogGroup": {
        "LogGroupArn": {
         "Fn::GetAtt": [
          "ApprovalStateMachineLogGrouplocalF9763D65",
          "Arn"
         ]
        }
       }
      }
     ],
     "IncludeExecutionData": true,
     "Level": "ALL"
    },
    "RoleArn": {
     "Fn::GetAtt": [
      "StateMachineRole78EC082E",
      "Arn"
     ]
    },
    "StateMachineName": {
     "Fn::Join": [
      "",
      [
       "ApprovalStateMachine-",
       {
        "Ref": "AWS::StackName"
       }
      ]
     ]
    },
    "TracingConfiguration": {
     "Enabled": true
    }
   },
   "DependsOn": [
    "StateMachineRoleDefaultPolicy433448B5",
    "StateMachineRole78EC082E"
   ],
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ApprovalStateMachine/Resource"
   }
  },
  "ApprovalStateMachineEventsRole83695FBF": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "events.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ApprovalStateMachine/EventsRole/Resource"
   }
  },
  "ApprovalStateMachineEventsRoleDefaultPolicy94B86841": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "states:StartExecution",
       "Effect": "Allow",
       "Resource": {
        "Ref": "ApprovalStateMachine767589AA"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ApprovalStateMachineEventsRoleDefaultPolicy94B86841",
    "Roles": [
     {
      "Ref": "ApprovalStateMachineEventsRole83695FBF"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/ApprovalStateMachine/EventsRole/DefaultPolicy/Resource"
   }
  },
  "unicornpropertiesPublicationApprovalRequested1AA17865": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "EventBusName": {
     "Ref": "UnicornPropertiesBuslocal2042F62D"
    },
    "EventPattern": {
     "detail-type": [
      "PublicationApprovalRequested"
     ],
     "source": [
      "unicorn.web"
     ]
    },
    "Name": "unicorn.properties-PublicationApprovalRequested",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Ref": "ApprovalStateMachine767589AA"
      },
      "DeadLetterConfig": {
       "Arn": {
        "Fn::GetAtt": [
         "PropertiesEventBusRuleDLQE70E543B",
         "Arn"
        ]
       }
      },
      "Id": "Target0",
      "RoleArn": {
       "Fn::GetAtt": [
        "ApprovalStateMachineEventsRole83695FBF",
        "Arn"
       ]
      }
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/unicorn.properties-PublicationApprovalRequested/Resource"
   }
  },
  "PublicationEvaluationCompletedSchema": {
   "Type": "AWS::EventSchemas::Schema",
   "Properties": {
    "Content": "{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"version\": \"1.0.0\",\n    \"title\": \"PublicationEvaluationCompleted\"\n  },\n  \"paths\": {},\n  \"components\": {\n    \"schemas\": {\n      \"AWSEvent\": {\n        \"type\": \"object\",\n        \"required\": [\n          \"detail-type\",\n          \"resources\",\n          \"detail\",\n          \"id\",\n          \"source\",\n          \"time\",\n          \"region\",\n          \"version\",\n          \"account\"\n        ],\n        \"x-amazon-events-detail-type\": \"PublicationEvaluationCompleted\",\n        \"x-amazon-events-source\": \"unicorn.web\",\n        \"properties\": {\n          \"detail\": {\n            \"$ref\": \"#/components/schemas/PublicationEvaluationCompleted\"\n          },\n          \"account\": {\n            \"type\": \"string\"\n          },\n          \"detail-type\": {\n            \"type\": \"string\"\n          },\n          \"id\": {\n            \"type\": \"string\"\n          },\n          \"region\": {\n            \"type\": \"string\"\n          },\n          \"resources\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"string\"\n            }\n          },\n          \"source\": {\n            \"type\": \"string\"\n          },\n          \"time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\"\n          },\n          \"version\": {\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"PublicationEvaluationCompleted\": {\n        \"type\": \"object\",\n        \"required\": [\n          \"property_id\",\n          \"evaluation_result\"\n        ],\n        \"properties\": {\n          \"property_id\": {\n            \"type\": \"string\"\n          },\n          \"evaluation_result\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    }\n  }\n}",
    "Description": "The schema for when a property evaluation is completed",
    "RegistryName": "unicorn.properties-local",
    "SchemaName": "unicorn.properties-local@PublicationEvaluationCompleted",
    "Type": "OpenApi3"
   },
   "DependsOn": [
    "uniproplocalpropertiesEventSchemaSackunicornproperties94C67D84"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/PublicationEvaluationCompletedSchema"
   }
  },
  "uniproplocalpropertiesEventSchemaSackunicornproperties94C67D84": {
   "Type": "AWS::EventSchemas::Registry",
   "Properties": {
    "Description": "Event schemas for unicorn.properties",
    "RegistryName": "unicorn.properties-local"
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/uni-prop-local-properties-EventSchemaSack/unicorn.properties"
   }
  },
  "uniproplocalpropertiesEventSchemaSackRegistryPolicy15A5C8CD": {
   "Type": "AWS::EventSchemas::RegistryPolicy",
   "Properties": {
    "Policy": {
     "Statement": [
      {
       "Action": [
        "schemas:DescribeCodeBinding",
        "schemas:DescribeRegistry",
        "schemas:DescribeSchema",
        "schemas:GetCodeBindingSource",
        "schemas:ListSchemaVersions",
        "schemas:ListSchemas",
        "schemas:SearchSchemas"
       ],
       "Effect": "Allow",
       "Principal": {
        "AWS": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":iam::",
           {
            "Ref": "AWS::AccountId"
           },
           ":root"
          ]
         ]
        }
       },
       "Resource": [
        {
         "Fn::GetAtt": [
          "PublicationEvaluationCompletedSchema",
          "SchemaArn"
         ]
        },
        {
         "Fn::GetAtt": [
          "uniproplocalpropertiesEventSchemaSackunicornproperties94C67D84",
          "RegistryArn"
         ]
        }
       ],
       "Sid": "AllowExternalServices"
      }
     ],
     "Version": "2012-10-17"
    },
    "RegistryName": "unicorn.properties-local"
   },
   "DependsOn": [
    "PublicationEvaluationCompletedSchema"
   ],
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/uni-prop-local-properties-EventSchemaSack/RegistryPolicy"
   }
  },
  "uniproplocalpropertiesSubscriptionsStackContractEventsBusPublishPolicy55ADE663": {
   "Type": "AWS::Events::EventBusPolicy",
   "Properties": {
    "EventBusName": {
     "Ref": "UnicornPropertiesBuslocal2042F62D"
    },
    "Statement": {
     "Action": [
      "events:PutRule",
      "events:DeleteRule",
      "events:DescribeRule",
      "events:DisableRule",
      "events:EnableRule",
      "events:PutTargets",
      "events:RemoveTargets"
     ],
     "Condition": {
      "StringEquals": {
       "events:source": [
        "unicorn.properties"
       ]
      },
      "StringEqualsIfExists": {
       "events:creatorAccount": {
        "Ref": "AWS::AccountId"
       }
      },
      "Null": {
       "events:source": "false"
      }
     },
     "Effect": "Allow",
     "Principal": {
      "AWS": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":iam::",
         {
          "Ref": "AWS::AccountId"
         },
         ":root"
        ]
       ]
      }
     },
     "Resource": {
      "Fn::GetAtt": [
       "UnicornPropertiesBuslocal2042F62D",
       "Arn"
      ]
     }
    },
    "StatementId": {
     "Fn::Join": [
      "",
      [
       {
        "Ref": "UnicornPropertiesBuslocal2042F62D"
       },
       "-local-policy"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/uni-prop-local-properties-SubscriptionsStack/ContractEventsBusPublishPolicy"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/21RQW7CMBB8C3fjFlKpZ0Atl6KmpOoVbZwluDh26rWLIit/r2wCpFUv3pmxvDs7nvPZY8YfJnCiqaiOUyVLHgoH4sjgRLuA36gd8fAU69ITW+31fzg3SoqObb3CKMfaM2Vq4uHF1GtrfBv1C+6ZgqasgIdC6lqhM/rZa+Gk0ewKVns9xjnaRhJFlqYWxluBG2hbqeurl19qzyQ0PAzmYo/BphlsmmiTsh0QoSO+iIVRxpdeHNEtgZBVnYbGVCUP71Aq/JjHh2tlSlBJ6Bl9EQ9vHn3qeQbpvM0d0Z6Rw3Y/LEYpbYcbEAepU4Mx79n5A8QBGyAe4nXCyT3WkpztxniY0TPhyZlmZ5FSIMQXJ1olbTtI7C+NXW74EuxVS+EUDuoh7hwsNOjQRvLqXetdRCujKxlX61neuYPRdxmfZfx+8klSTq3XTjbIt+f6A6iI8Nd/AgAA"
   },
   "Metadata": {
    "aws:cdk:path": "uni-prop-local-properties/CDKMetadata/Default"
   },
   "Condition": "CDKMetadataAvailable"
  }
 },
 "Mappings": {
  "LatestNodeRuntimeMap": {
   "af-south-1": {
    "value": "nodejs20.x"
   },
   "ap-east-1": {
    "value": "nodejs20.x"
   },
   "ap-northeast-1": {
    "value": "nodejs20.x"
   },
   "ap-northeast-2": {
    "value": "nodejs20.x"
   },
   "ap-northeast-3": {
    "value": "nodejs20.x"
   },
   "ap-south-1": {
    "value": "nodejs20.x"
   },
   "ap-south-2": {
    "value": "nodejs20.x"
   },
   "ap-southeast-1": {
    "value": "nodejs20.x"
   },
   "ap-southeast-2": {
    "value": "nodejs20.x"
   },
   "ap-southeast-3": {
    "value": "nodejs20.x"
   },
   "ap-southeast-4": {
    "value": "nodejs20.x"
   },
   "ap-southeast-5": {
    "value": "nodejs20.x"
   },
   "ap-southeast-7": {
    "value": "nodejs20.x"
   },
   "ca-central-1": {
    "value": "nodejs20.x"
   },
   "ca-west-1": {
    "value": "nodejs20.x"
   },
   "cn-north-1": {
    "value": "nodejs18.x"
   },
   "cn-northwest-1": {
    "value": "nodejs18.x"
   },
   "eu-central-1": {
    "value": "nodejs20.x"
   },
   "eu-central-2": {
    "value": "nodejs20.x"
   },
   "eu-north-1": {
    "value": "nodejs20.x"
   },
   "eu-south-1": {
    "value": "nodejs20.x"
   },
   "eu-south-2": {
    "value": "nodejs20.x"
   },
   "eu-west-1": {
    "value": "nodejs20.x"
   },
   "eu-west-2": {
    "value": "nodejs20.x"
   },
   "eu-west-3": {
    "value": "nodejs20.x"
   },
   "il-central-1": {
    "value": "nodejs20.x"
   },
   "me-central-1": {
    "value": "nodejs20.x"
   },
   "me-south-1": {
    "value": "nodejs20.x"
   },
   "mx-central-1": {
    "value": "nodejs20.x"
   },
   "sa-east-1": {
    "value": "nodejs20.x"
   },
   "us-east-1": {
    "value": "nodejs20.x"
   },
   "us-east-2": {
    "value": "nodejs20.x"
   },
   "us-west-1": {
    "value": "nodejs20.x"
   },
   "us-west-2": {
    "value": "nodejs20.x"
   }
  }
 },
 "Parameters": {
  "SsmParameterValueuniproplocalImagesBucketC96584B6F00A464EAD1953AFF4B05118Parameter": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/uni-prop/local/ImagesBucket"
  },
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Outputs": {
  "ContractStatusTableName": {
   "Description": "DynamoDB table storing contract status information",
   "Value": {
    "Ref": "ContractStatusTableF5E34442"
   }
  },
  "ContractStatusChangedHandlerFunctionName": {
   "Description": "ContractStatusChangedHandler function name",
   "Value": {
    "Ref": "ContractStatusChangedHandlerFunctionlocalE63ECA03"
   }
  },
  "ContractStatusChangedHandlerFunctionArn": {
   "Description": "ContractStatusChangedHandler function ARN",
   "Value": {
    "Fn::GetAtt": [
     "ContractStatusChangedHandlerFunctionlocalE63ECA03",
     "Arn"
    ]
   }
  },
  "PropertiesApprovalSyncFunctionName": {
   "Value": {
    "Ref": "PropertiesApprovalSyncFunctionlocal69C8A5CE"
   }
  },
  "PropertiesApprovalSyncFunctionArn": {
   "Value": {
    "Fn::GetAtt": [
     "PropertiesApprovalSyncFunctionlocal69C8A5CE",
     "Arn"
    ]
   }
  },
  "ContractExistsCheckerFunctionNName": {
   "Value": {
    "Ref": "ContractExistsCheckerFunctionlocalA9DDED8C"
   }
  },
  "ContractExistsCheckerFunctionArn": {
   "Value": {
    "Fn::GetAtt": [
     "ContractExistsCheckerFunctionlocalA9DDED8C",
     "Arn"
    ]
   }
  },
  "ContentIntegrityValidatorFunctionNName": {
   "Value": {
    "Ref": "ContentIntegrityValidatorFunctionlocal05E28B54"
   }
  },
  "ContentIntegrityValidatorFunctionArn": {
   "Value": {
    "Fn::GetAtt": [
     "ContentIntegrityValidatorFunctionlocal05E28B54",
     "Arn"
    ]
   }
  },
  "WaitForContractApprovalFunctionNName": {
   "Value": {
    "Ref": "WaitForContractApprovalFunctionlocalB37F63DE"
   }
  },
  "WaitForContractApprovalFunctionArn": {
   "Value": {
    "Fn::GetAtt": [
     "WaitForContractApprovalFunctionlocalB37F63DE",
     "Arn"
    ]
   }
  },
  "ApprovalStateMachineName": {
   "Value": {
    "Fn::GetAtt": [
     "ApprovalStateMachine767589AA",
     "Name"
    ]
   }
  },
  "ApprovalStateMachineArn": {
   "Value": {
    "Ref": "ApprovalStateMachine767589AA"
   }
  },
  "UnicornPropertiesEventBusName": {
   "Value": {
    "Ref": "UnicornPropertiesBuslocal2042F62D"
   }
  },
  "UnicornPropertiesCatchAllLogGroupArn": {
   "Description": "Log all events on the service's EventBridge Bus",
   "Value": {
    "Fn::GetAtt": [
     "UnicornPropertiesCatchAllLogGroup057F9994",
     "Arn"
    ]
   }
  },
  "ApprovalStateMachineLogGroupName": {
   "Value": {
    "Ref": "ApprovalStateMachineLogGrouplocalF9763D65"
   }
  }
 },
 "Conditions": {
  "CDKMetadataAvailable": {
   "Fn::Or": [
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "af-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-3"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-4"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-northwest-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-2"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "il-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "sa-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-1"
       ]
      }
     ]
    },
    {
     "Fn::Equals": [
      {
       "Ref": "AWS::Region"
      },
      "us-west-2"
     ]
    }
   ]
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}